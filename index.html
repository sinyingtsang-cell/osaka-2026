{\rtf1\ansi\ansicpg950\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!DOCTYPE html>\
<html lang="zh-TW">\
<head>\
    <meta charset="UTF-8">\
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">\
    <title>\uc0\u55356 \u57144  2026 \u22823 \u38442 \u26149 \u26085 \u36062 \u27387 \u20043 \u26053 </title>\
    <script src="https://cdn.tailwindcss.com"></script>\
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>\
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">\
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>\
    \
    <script>\
        tailwind.config = \{\
            theme: \{\
                extend: \{ colors: \{ brand: '#2DD4BF', brandDark: '#14B8A6', bgLight: '#F3F4F6' \} \}\
            \}\
        \}\
    </script>\
    <style>\
        body \{ background-color: #f9fafb; font-family: 'Helvetica Neue', Arial, sans-serif; \}\
        .no-scrollbar::-webkit-scrollbar \{ display: none; \}\
        .no-scrollbar \{ -ms-overflow-style: none; scrollbar-width: none; \}\
        .masonry \{ column-count: 2; column-gap: 1rem; \}\
        .masonry-item \{ break-inside: avoid; margin-bottom: 1rem; \}\
        .app-container \{ max-width: 480px; margin: 0 auto; background: white; min-height: 100vh; position: relative; padding-bottom: 80px; box-shadow: 0 0 20px rgba(0,0,0,0.05); \}\
    </style>\
</head>\
<body>\
\
<div id="app" class="app-container">\
    <div class="sticky top-0 z-50 bg-white shadow-sm">\
        <h1 class="text-xl font-bold text-center py-4 text-gray-800">\uc0\u55356 \u57144  2026 \u22823 \u38442 \u26149 \u26085 \u36062 \u27387 \u20043 \u26053 </h1>\
        <div class="bg-brand text-white text-xs text-center py-1.5 flex justify-center items-center gap-2">\
            <i class="fa-solid fa-yen-sign"></i>\
            <span>\uc0\u20170 \u26085 \u21295 \u29575 \u65306 1 HKD \u8776  \{\{ exchangeRate.toFixed(2) \}\} JPY</span>\
            <button @click="fetchExchangeRate" class="hover:text-gray-200"><i class="fa-solid fa-rotate"></i></button>\
        </div>\
    </div>\
\
    <div class="p-4">\
        \
        <div v-show="activeTab === 'itinerary'" class="space-y-4">\
            <h2 class="text-lg font-bold text-gray-700 border-l-4 border-brand pl-2">\uc0\u34892 \u31243 \u34920 </h2>\
            <div v-for="(day, index) in itinerary" :key="index" class="bg-bgLight rounded-xl p-4 shadow-sm">\
                <h3 class="font-bold text-brandDark mb-3">\{\{ day.title \}\}</h3>\
                <div v-for="(item, i) in day.places" :key="i" class="flex justify-between items-center bg-white p-3 rounded-lg mb-2 shadow-sm border border-gray-100">\
                    <div>\
                        <p class="text-sm text-gray-500">\{\{ item.time \}\}</p>\
                        <p class="font-medium text-gray-800">\{\{ item.name \}\}</p>\
                    </div>\
                    <a :href="'http://googleusercontent.com/maps.google.com/maps?q=' + encodeURIComponent(item.name)" target="_blank" class="bg-brand text-white p-2 rounded-full w-10 h-10 flex items-center justify-center hover:bg-brandDark transition">\
                        <i class="fa-solid fa-location-arrow"></i>\
                    </a>\
                </div>\
            </div>\
        </div>\
\
        <div v-show="activeTab === 'expenses'" class="space-y-4">\
            <div class="flex justify-between items-center">\
                <h2 class="text-lg font-bold text-gray-700 border-l-4 border-brand pl-2">\uc0\u20844 \u36027 \u32080 \u31639 \u33287 \u21295 \u20837 </h2>\
                <input type="file" ref="excelInput" @change="importExcel" accept=".xlsx, .xls, .csv" class="hidden">\
                <button @click="$refs.excelInput.click()" class="bg-gray-800 text-white px-3 py-1.5 rounded-lg text-sm font-bold flex items-center gap-1 shadow-sm">\
                    <i class="fa-solid fa-file-excel"></i> \uc0\u21295 \u20837  Excel\
                </button>\
            </div>\
\
            <div class="bg-green-50 border border-green-200 p-4 rounded-xl shadow-sm">\
                <h3 class="font-bold text-green-800 mb-2"><i class="fa-solid fa-handshake"></i> \uc0\u26368 \u32066 \u36681 \u24115 \u28165 \u21934 </h3>\
                <div v-if="settlementTransactions.length === 0" class="text-sm text-green-600">\uc0\u30446 \u21069 \u24115 \u30446 \u20114 \u19981 \u30456 \u27424 \u65292 \u25110 \u23578 \u26410 \u26032 \u22686 \u33457 \u36027 \u12290 </div>\
                <ul class="space-y-2">\
                    <li v-for="(txn, idx) in settlementTransactions" :key="idx" class="text-sm flex justify-between items-center bg-white p-2 rounded border border-green-100">\
                        <span class="font-bold text-gray-700">\{\{ txn.from \}\}</span>\
                        <span class="text-gray-400 text-xs">\uc0\u38656 \u36681 \u32102  <i class="fa-solid fa-arrow-right text-brand"></i></span>\
                        <span class="font-bold text-gray-700">\{\{ txn.to \}\}</span>\
                        <div class="text-right">\
                            <span class="font-bold text-brandDark block">\'a5 \{\{ txn.jpy \}\}</span>\
                            <span class="text-[10px] text-gray-400">HKD \{\{ (txn.jpy / exchangeRate).toFixed(1) \}\}</span>\
                        </div>\
                    </li>\
                </ul>\
            </div>\
\
            <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">\
                <div class="flex gap-2 mb-2">\
                    <input v-model.number="newExpenseJPY" type="number" placeholder="\uc0\u37329 \u38989  (JPY)" class="w-1/2 border-b-2 border-brand focus:outline-none py-2 text-lg">\
                    <select v-model="newExpensePayer" class="w-1/2 border-b-2 border-brand focus:outline-none py-2 bg-transparent text-gray-700">\
                        <option v-for="member in members" :key="member" :value="member">\{\{ member \}\} \uc0\u20808 \u20184 </option>\
                    </select>\
                </div>\
                <p class="text-xs text-gray-400 mb-4">\uc0\u32004 \u21512  HKD: \{\{ (newExpenseJPY / exchangeRate).toFixed(1) || 0 \}\}</p>\
                <input v-model="newExpenseDesc" type="text" placeholder="\uc0\u33457 \u36027 \u38917 \u30446  (\u20363 \u65306 \u26202 \u39184 )" class="w-full bg-gray-50 rounded-lg p-2 mb-3 outline-none">\
                <button @click="addExpense" class="w-full bg-brand text-white font-bold py-2 rounded-lg">\uc0\u26032 \u22686 \u32000 \u37636 </button>\
            </div>\
            \
            <div class="space-y-2">\
                <div v-for="(exp, index) in expenses" :key="index" class="flex justify-between items-center bg-white p-3 rounded-lg shadow-sm">\
                    <div>\
                        <p class="font-bold text-gray-800">\{\{ exp.desc \}\}</p>\
                        <p class="text-xs text-brandDark"><i class="fa-solid fa-user text-[10px]"></i> \{\{ exp.paidBy \}\} \uc0\u20195 \u22666 </p>\
                    </div>\
                    <div class="text-right">\
                        <p class="font-bold text-gray-800">\'a5 \{\{ exp.jpy \}\}</p>\
                        <p class="text-xs text-gray-400">HKD \{\{ (exp.jpy / exchangeRate).toFixed(1) \}\}</p>\
                        <button @click="expenses.splice(index, 1)" class="text-red-400 text-xs mt-1"><i class="fa-solid fa-trash"></i> \uc0\u21034 \u38500 </button>\
                    </div>\
                </div>\
            </div>\
        </div>\
\
        <div v-show="activeTab === 'shopping'" class="space-y-4">\
            <h2 class="text-lg font-bold text-gray-700 border-l-4 border-brand pl-2">\uc0\u36092 \u29289 \u28165 \u21934 </h2>\
            <p class="text-sm text-gray-500">\uc0\u65288 \u36092 \u29289 \u33287 \u34892 \u26446 \u21151 \u33021 \u24050 \u36617 \u20837 \u65289 </p>\
        </div>\
        <div v-show="activeTab === 'luggage'" class="space-y-4">\
            <h2 class="text-lg font-bold text-gray-700 border-l-4 border-brand pl-2">\uc0\u34892 \u26446 \u28165 \u21934 </h2>\
             <p class="text-sm text-gray-500">\uc0\u65288 \u36092 \u29289 \u33287 \u34892 \u26446 \u21151 \u33021 \u24050 \u36617 \u20837 \u65289 </p>\
        </div>\
        <div v-show="activeTab === 'photos'" class="space-y-4">\
            <h2 class="text-lg font-bold text-gray-700 border-l-4 border-brand pl-2">\uc0\u22238 \u25014 \u30456 \u29255 \u29254 </h2>\
             <p class="text-sm text-gray-500">\uc0\u65288 \u36092 \u29289 \u33287 \u34892 \u26446 \u21151 \u33021 \u24050 \u36617 \u20837 \u65289 </p>\
        </div>\
    </div>\
\
    <div class="fixed bottom-0 w-full max-w-[480px] bg-white border-t border-gray-200 flex justify-around items-center py-3 pb-6 px-2 shadow-[0_-5px_10px_rgba(0,0,0,0.02)] z-50">\
        <button @click="activeTab = 'itinerary'" :class="activeTab === 'itinerary' ? 'text-brand' : 'text-gray-400'" class="flex flex-col items-center flex-1 transition-colors">\
            <i class="fa-solid fa-map-location-dot text-xl mb-1"></i><span class="text-[10px]">\uc0\u34892 \u31243 </span>\
        </button>\
        <button @click="activeTab = 'expenses'" :class="activeTab === 'expenses' ? 'text-brand' : 'text-gray-400'" class="flex flex-col items-center flex-1 transition-colors">\
            <i class="fa-solid fa-wallet text-xl mb-1"></i><span class="text-[10px]">\uc0\u20998 \u24115 </span>\
        </button>\
        </div>\
</div>\
\
<script>\
    const \{ createApp, ref, computed, watch, onMounted \} = Vue\
\
    createApp(\{\
        setup() \{\
            const activeTab = ref('expenses') // \uc0\u38928 \u35373 \u25171 \u38283 \u20998 \u24115 \u38913 \u38754 \u26041 \u20415 \u28204 \u35430 \
            const exchangeRate = ref(19.5)\
            \
            // \uc0\u26053 \u20276 \u21517 \u21934 \u35373 \u23450  (\u21487 \u33258 \u34892 \u22312 \u27492 \u26032 \u22686 /\u20462 \u25913 \u21517 \u23383 )\
            const members = ref(['\uc0\u33258 \u24049 ', '\u26053 \u20276 A', '\u26053 \u20276 B'])\
\
            const fetchExchangeRate = async () => \{\
                try \{\
                    const res = await fetch('https://api.exchangerate-api.com/v4/latest/HKD');\
                    const data = await res.json();\
                    if(data?.rates?.JPY) exchangeRate.value = data.rates.JPY;\
                \} catch (e) \{ console.log('\uc0\u21295 \u29575 \u26356 \u26032 \u22833 \u25943 '); \}\
            \}\
\
            // --- \uc0\u26680 \u24515 \u36039 \u26009  ---\
            const itinerary = ref([\
                \{ title: 'Day 1: \uc0\u25269 \u36948 \u33287 \u36891 \u34903 ', places: [\{ time: '14:00', name: '\u38364 \u35199 \u22283 \u38555 \u27231 \u22580 ' \}, \{ time: '18:00', name: '\u36947 \u38931 \u22528 ' \}] \}\
            ])\
\
            const expenses = ref([])\
            const newExpenseJPY = ref('')\
            const newExpenseDesc = ref('')\
            const newExpensePayer = ref('\uc0\u33258 \u24049 ') // \u38928 \u35373 \u20184 \u27454 \u20154 \
\
            // --- \uc0\u26032 \u22686 \u33457 \u36027  ---\
            const addExpense = () => \{\
                if (newExpenseJPY.value && newExpenseDesc.value && newExpensePayer.value) \{\
                    expenses.value.push(\{ \
                        jpy: newExpenseJPY.value, \
                        desc: newExpenseDesc.value,\
                        paidBy: newExpensePayer.value\
                    \})\
                    newExpenseJPY.value = ''; newExpenseDesc.value = '';\
                \}\
            \}\
\
            // --- \uc0\u55358 \u56598  \u32066 \u26997 \u32080 \u31639 \u28436 \u31639 \u27861  (Debt Simplification) ---\
            const settlementTransactions = computed(() => \{\
                if (expenses.value.length === 0) return [];\
                \
                // 1. \uc0\u35336 \u31639 \u27599 \u20491 \u20154 \u30340 \u20195 \u22666 \u32317 \u38989 \
                let balances = \{\};\
                members.value.forEach(m => balances[m] = 0);\
                \
                let totalSpent = 0;\
                expenses.value.forEach(exp => \{\
                    totalSpent += exp.jpy;\
                    if(balances[exp.paidBy] !== undefined) \{\
                        balances[exp.paidBy] += exp.jpy;\
                    \} else \{\
                        // \uc0\u22914 \u26524 \u26377 \u19981 \u22312 \u21517 \u21934 \u19978 \u30340 \u20154 \u20184 \u27454 \u65292 \u21205 \u24907 \u21152 \u20837 \
                        balances[exp.paidBy] = exp.jpy;\
                        members.value.push(exp.paidBy);\
                    \}\
                \});\
\
                // 2. \uc0\u35336 \u31639 \u27599 \u20491 \u20154 \u12300 \u25033 \u20184 \u24179 \u22343 \u38989 \u12301 \
                let perPerson = totalSpent / members.value.length;\
                let debtors = []; // \uc0\u27424 \u37666 \u30340 \u20154  (\u39192 \u38989 \u28858 \u36000 )\
                let creditors = []; // \uc0\u20511 \u20986 \u30340 \u20154  (\u39192 \u38989 \u28858 \u27491 )\
\
                for (let m in balances) \{\
                    let diff = balances[m] - perPerson;\
                    if (diff < -0.1) debtors.push(\{ name: m, amount: Math.abs(diff) \});\
                    else if (diff > 0.1) creditors.push(\{ name: m, amount: diff \});\
                \}\
\
                // 3. \uc0\u35336 \u31639 \u35504 \u35442 \u36681 \u24115 \u32102 \u35504  (\u36010 \u23146 \u28436 \u31639 \u27861 )\
                let transactions = [];\
                let i = 0, j = 0;\
                while (i < debtors.length && j < creditors.length) \{\
                    let amountToSettle = Math.min(debtors[i].amount, creditors[j].amount);\
                    \
                    transactions.push(\{\
                        from: debtors[i].name,\
                        to: creditors[j].name,\
                        jpy: Math.round(amountToSettle)\
                    \});\
\
                    debtors[i].amount -= amountToSettle;\
                    creditors[j].amount -= amountToSettle;\
\
                    if (debtors[i].amount < 0.1) i++;\
                    if (creditors[j].amount < 0.1) j++;\
                \}\
                return transactions;\
            \})\
\
            // --- \uc0\u55357 \u56513  \u35712 \u21462  Excel \u27284 \u26696 \u21151 \u33021  ---\
            const importExcel = (event) => \{\
                const file = event.target.files[0];\
                if (!file) return;\
\
                const reader = new FileReader();\
                reader.onload = (e) => \{\
                    try \{\
                        const data = new Uint8Array(e.target.result);\
                        // \uc0\u20351 \u29992  SheetJS \u35299 \u26512 \
                        const workbook = XLSX.read(data, \{ type: 'array' \});\
                        const firstSheetName = workbook.SheetNames[0];\
                        const worksheet = workbook.Sheets[firstSheetName];\
                        \
                        // \uc0\u36681 \u25104  JSON \u38499 \u21015 \
                        const json = XLSX.utils.sheet_to_json(worksheet);\
                        \
                        // \uc0\u36941 \u27511  Excel \u30340 \u27599 \u19968 \u34892 \u65292 \u23531 \u20837  App\
                        let importCount = 0;\
                        json.forEach(row => \{\
                            // \uc0\u20551 \u35373  Excel \u27396 \u20301 \u21517 \u31281 \u21483 \u20570  "\u38917 \u30446 "\u12289 "\u37329 \u38989 "\u12289 "\u20184 \u27454 \u20154 "\
                            const desc = row['\uc0\u38917 \u30446 '] || row['Item'] || '\u26410 \u21629 \u21517 \u38917 \u30446 ';\
                            const amount = parseInt(row['\uc0\u37329 \u38989 '] || row['Amount'] || 0);\
                            const payer = row['\uc0\u20184 \u27454 \u20154 '] || row['Payer'] || '\u33258 \u24049 ';\
\
                            if (amount > 0) \{\
                                expenses.value.push(\{ jpy: amount, desc: desc, paidBy: payer \});\
                                importCount++;\
                            \}\
                        \});\
                        alert(`\uc0\u25104 \u21151 \u21295 \u20837  $\{importCount\} \u31558 \u33457 \u36027 \u32000 \u37636 \u65281 \u32080 \u31639 \u24050 \u33258 \u21205 \u26356 \u26032 \u12290 `);\
                    \} catch (error) \{\
                        alert('\uc0\u35712 \u21462  Excel \u22833 \u25943 \u65292 \u35531 \u30906 \u35469 \u27284 \u26696 \u26684 \u24335 \u26159 \u21542 \u27491 \u30906 \u12290 ');\
                        console.error(error);\
                    \}\
                    // \uc0\u28165 \u31354  input\u65292 \u20801 \u35377 \u37325 \u35079 \u19978 \u20659 \u21516 \u20491 \u27284 \u26696 \
                    event.target.value = '';\
                \};\
                reader.readAsArrayBuffer(file);\
            \}\
\
            // --- \uc0\u20786 \u23384 \u33287 \u35712 \u21462  ---\
            const saveData = () => \{ localStorage.setItem('osakaApp', JSON.stringify(\{ expenses: expenses.value, members: members.value \})) \}\
            const loadData = () => \{\
                const saved = localStorage.getItem('osakaApp');\
                if (saved) \{\
                    const parsed = JSON.parse(saved);\
                    if (parsed.expenses) expenses.value = parsed.expenses;\
                    if (parsed.members) members.value = parsed.members;\
                \}\
            \}\
\
            watch([expenses, members], saveData, \{ deep: true \})\
\
            onMounted(() => \{\
                loadData();\
                fetchExchangeRate();\
            \})\
\
            return \{\
                activeTab, exchangeRate, fetchExchangeRate,\
                itinerary, expenses, members,\
                newExpenseJPY, newExpenseDesc, newExpensePayer, addExpense,\
                settlementTransactions, importExcel\
            \}\
        \}\
    \}).mount('#app')\
</script>\
</body>\
</html>}